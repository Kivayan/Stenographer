<Window x:Class="Stenographer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Stenographer"
        Height="1000"
        Width="800"
        MinHeight="900"
        MinWidth="720"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Menu Grid.Row="0" Background="#111827" Foreground="White" Height="30">
            <MenuItem Header="_Model Management"
                      x:Name="ModelManagementMenuItem"
                      SubmenuOpened="ModelManagementMenuItem_SubmenuOpened">
                <MenuItem Header="Show Model Manager Tab" Click="OpenModelManagerMenuItem_Click" />
                <Separator />
                <MenuItem Header="Installed Models" x:Name="InstalledModelsMenuItem" />
                <MenuItem Header="Available for Download" x:Name="AvailableModelsMenuItem" />
            </MenuItem>
        </Menu>

        <Border Grid.Row="1" Background="#1F2937" Height="120">
            <StackPanel VerticalAlignment="Center" Margin="20">
                <TextBlock Text="Stenographer" Foreground="White" FontSize="28" FontWeight="Bold" />
                <TextBlock Text="Local voice-to-text assistant" Foreground="#E5E7EB" Margin="0,8,0,0" />
            </StackPanel>
        </Border>

        <Border Grid.Row="2" Background="White" Margin="24" Padding="20" CornerRadius="12" BorderBrush="#E5E7EB" BorderThickness="1">
            <TabControl x:Name="MainTabControl">
                <TabItem Header="Recorder">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                        <StackPanel>
                            <TextBlock Text="Status" FontWeight="SemiBold" />
                            <TextBlock x:Name="StatusText" Text="Initializing..." Margin="0,8,0,0" />
                            <TextBlock x:Name="RecordingFileText" Margin="0,4,0,0" Foreground="#4B5563" TextWrapping="Wrap" />

                            <Separator Margin="0,16,0,16" />

                            <TextBlock Text="Input Device" FontWeight="SemiBold" />
                            <ComboBox x:Name="DeviceComboBox" DisplayMemberPath="FriendlyName" Margin="0,8,0,0" Height="32" />

                            <Button x:Name="RecordButton" Content="Start Recording" Margin="0,16,0,0" Height="40" FontSize="16" Click="RecordButton_Click" />

                            <Separator Margin="0,16,0,16" />

                            <TextBlock Text="Global Hotkey" FontWeight="SemiBold" />
                            <StackPanel Orientation="Horizontal" Margin="0,8,0,0" VerticalAlignment="Center">
                                <TextBox x:Name="HotkeyTextBox" Width="220" Height="32" IsReadOnly="True" VerticalContentAlignment="Center" />
                                <Button x:Name="EditHotkeyButton" Content="Change" Margin="8,0,0,0" Height="32" Width="80" Click="EditHotkeyButton_Click" />
                                <Button x:Name="ResetHotkeyButton" Content="Reset" Margin="8,0,0,0" Height="32" Width="80" Click="ResetHotkeyButton_Click" />
                            </StackPanel>
                            <TextBlock x:Name="HotkeyStatusText" FontSize="12" Foreground="#4B5563" Margin="0,4,0,0" Text="Press and hold the hotkey to record." />

                            <Separator Margin="0,16,0,16" />

                            <TextBlock Text="Language" FontWeight="SemiBold" />
                            <ComboBox x:Name="LanguageComboBox" Margin="0,8,0,0" Height="32" DisplayMemberPath="DisplayName" SelectionChanged="LanguageComboBox_SelectionChanged" />
                            <TextBlock x:Name="LanguageStatusText" FontSize="12" Foreground="#4B5563" Margin="0,4,0,0" Text="Whisper will auto-detect the language." />

                            <Separator Margin="0,16,0,16" />

                            <TextBlock Text="Whisper Model" FontWeight="SemiBold" />
                            <ComboBox x:Name="ModelComboBox" Margin="0,8,0,0" Height="32" DisplayMemberPath="DisplayName" SelectionChanged="ModelComboBox_SelectionChanged" />
                            <TextBlock x:Name="ModelStatusText" FontSize="12" Foreground="#4B5563" Margin="0,4,0,0" Text="Select a model for transcription." />
                            <Button x:Name="ManageModelsButton" Content="Show Model Manager Tab" Margin="0,8,0,0" Height="32" Width="220" Click="ManageModelsButton_Click" />

                            <Separator Margin="0,16,0,16" />

                            <TextBlock Text="Transcription" FontWeight="SemiBold" />
                            <ScrollViewer Height="120" Margin="0,8,0,0">
                                <TextBox x:Name="ResultTextBox" TextWrapping="Wrap" AcceptsReturn="True" IsReadOnly="True" BorderThickness="0" Background="Transparent" Text="Recording not started." />
                            </ScrollViewer>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                <TabItem Header="Model Management">
                    <Grid Margin="0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <TextBlock Text="Manage installed Whisper models and download new ones."
                                   FontSize="14"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,12" />

                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <GroupBox Header="Installed Models" Grid.Column="0" Margin="0,0,8,0">
                                <Grid Margin="0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>

                                    <StackPanel Orientation="Horizontal" Grid.Row="0" HorizontalAlignment="Right" Margin="0,0,0,8">
                                        <Button x:Name="SetActiveModelButton" Content="Set Active" Width="120" Height="30" Margin="0,0,8,0" Click="SetActiveModelButton_Click" />
                                        <Button x:Name="OpenFolderButton" Content="Open Folder" Width="120" Height="30" Click="OpenFolderButton_Click" />
                                    </StackPanel>

                                    <ListView x:Name="InstalledModelsListView"
                                              Grid.Row="1"
                                              SelectionMode="Single"
                                              SelectionChanged="InstalledModelsListView_SelectionChanged">
                                        <ListView.View>
                                            <GridView>
                                                <GridViewColumn Header="Name" DisplayMemberBinding="{Binding FileName}" Width="220" />
                                                <GridViewColumn Header="Size" DisplayMemberBinding="{Binding FormattedSize}" Width="120" />
                                                <GridViewColumn Header="Path" DisplayMemberBinding="{Binding FilePath}" Width="220" />
                                            </GridView>
                                        </ListView.View>
                                    </ListView>
                                </Grid>
                            </GroupBox>

                            <GroupBox Header="Available Downloads" Grid.Column="1" Margin="8,0,0,0">
                                <Grid Margin="0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>

                                    <StackPanel Orientation="Horizontal" Grid.Row="0" HorizontalAlignment="Right" Margin="0,0,0,8">
                                        <Button x:Name="DownloadModelButton" Content="Download Selected" Width="160" Height="30" Margin="0,0,8,0" Click="DownloadModelButton_Click" />
                                        <Button x:Name="RefreshRemoteButton" Content="Refresh" Width="100" Height="30" Click="RefreshRemoteButton_Click" />
                                    </StackPanel>

                                    <ListView x:Name="RemoteModelsListView"
                                              Grid.Row="1"
                                              SelectionMode="Single"
                                              SelectionChanged="RemoteModelsListView_SelectionChanged">
                                        <ListView.View>
                                            <GridView>
                                                <GridViewColumn Header="Name" DisplayMemberBinding="{Binding FileName}" Width="220" />
                                                <GridViewColumn Header="Size" DisplayMemberBinding="{Binding FormattedSize}" Width="120" />
                                                <GridViewColumn Header="Download URL" DisplayMemberBinding="{Binding DownloadUri}" Width="220" />
                                            </GridView>
                                        </ListView.View>
                                    </ListView>
                                </Grid>
                            </GroupBox>
                        </Grid>

                        <StackPanel Grid.Row="2" Orientation="Vertical" Margin="0,16,0,0">
                            <ProgressBar x:Name="DownloadProgressBar" Height="20" Minimum="0" Maximum="100" Visibility="Collapsed" />
                            <TextBlock x:Name="ModelManagerStatusTextBlock" Margin="0,8,0,0" TextWrapping="Wrap" Text="Select a model to manage or refresh the remote catalog." />
                        </StackPanel>
                    </Grid>
                </TabItem>
            </TabControl>
        </Border>
    </Grid>
</Window>
